<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Lab 1: Pollinators</title>
  <script type="module">
    import * as Plot from "https://cdn.jsdelivr.net/npm/@observablehq/plot@0.6/+esm";

    // Fetch CSV data
    fetch("pollinator_activity_data.csv")
      .then(response => response.text())
      .then(csvText => {
        const rows = csvText.split("\n").slice(1).map(line => {
          const [pollinator_species, avg_body_mass_g, avg_wing_span_mm, flower_species, nectar_production, weather_condition, visit_count] = line.split(",");
          return {
            pollinator_species,
            avg_body_mass_g: +avg_body_mass_g,
            avg_wing_span_mm: +avg_wing_span_mm,
            flower_species,
            nectar_production: +nectar_production,
            weather_condition,
            visit_count: +visit_count
          };
        });

        // Plot 1: Body Mass vs Wing Span
        const plot1 = Plot.plot({
          title: "Body Mass vs Wing Span by Pollinator Species",
          x: { label: "Average Body Mass (g)" },
          y: { label: "Average Wing Span (mm)" },
          color: { legend: true },
          marks: [
            Plot.dot(rows, { x: "avg_body_mass_g", y: "avg_wing_span_mm", fill: "pollinator_species" })
          ]
        });
        document.body.appendChild(plot1);

        // Plot 2: Average Visit Count by Weather
        const plot2 = Plot.plot({
          title: "Average Visit Count by Weather Condition",
          x: { label: "Weather Condition" },
          y: { label: "Average Visit Count" },
          marks: [
            Plot.barY(
              rows,
              Plot.groupX({ y: "mean" }, { x: "weather_condition", y: "visit_count", fill: "weather_condition" })
            )
          ]
        });
        document.body.appendChild(plot2);

        // Plot 3: Average Nectar Production by Flower Species
        const plot3 = Plot.plot({
          title: "Average Nectar Production by Flower Species",
          x: { label: "Average Nectar Production (Î¼L)" },
          y: { label: "Flower Species" },
          marginLeft: 90,
          marks: [
            Plot.barX(
              rows,
              Plot.groupY({ x: "mean" }, { x: "nectar_production", y: "flower_species", fill: "lightgreen" })
            )
          ]
        });
        document.body.appendChild(plot3);

      });
  </script>
</head>
<body>
</body>
</html>
